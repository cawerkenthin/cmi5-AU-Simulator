function GetAgentProfile(){return cmi5Controller.getAgentProfile(endPointConfig,actor,setAgentProfile),!1}function GetAuthToken(){return cmi5Controller.getAuthToken(setAuthToken),!1}function GetStateDocument(){return cmi5Controller.getStateDocument(endPointConfig,activityId,actor,registration,setStateDocument),!1}function GoLMS(){if(typeof returnUrl=="string"&&returnUrl.length>0){var n=decodeURIComponent(returnUrl);return document.location.href=n,!1}return self.close(),!1}function SendStatement(){var f=jq("input:radio[name='rdoVerb']:checked").val(),s=jq("#txtScore").val(),h=jq("input:radio[name='rdoSuccess']:checked").val(),c=jq("input:radio[name='rdoComplete']:checked").val(),l,i=jq("#durationHours").val(),r=jq("#durationMinutes").val(),u=jq("#durationSeconds").val(),o,v,t,a,n,e;(i||r||u)&&(i||(i="0"),r||(r="0"),u||(u="0"),l=i+":"+r+":"+u);o=jq("#input_progress").val();v=JSON.parse(actor);switch(f){case"Initialized":t=ADL.verbs.initialized;break;case"Completed":t=ADL.verbs.completed;break;case"Passed":t=ADL.verbs.passed;break;case"Failed":t=ADL.verbs.failed;break;case"Terminated":t=ADL.verbs.terminated}return t?(a=contextExtensions,(f.toUpperCase()=="PASSED"||f.toUpperCase()=="FAILED")&&(a["https://w3id.org/xapi/cmi5/context/extensions/masteryScore"]=masteryScore),n=cmi5Controller.getcmi5DefinedStatement(v,t,activityProperties,registration,contextActivities,a),n.timestamp=(new Date).toISOString(),(h||c||s||l||o)&&(n.result={},c&&(n.result.completion=!0),h&&(n.result.success=!0),s&&(n.result.score={scaled:parseFloat(s)}),o&&(n.result.extensions={"https://w3id.org/xapi/cmi5/result/extensions/progress":parseInt(o)}),l&&(e="PT",i>0&&(e+=i+"H"),r>0&&(e+=r+"M"),u>0&&(e+=u+"S"),n.result.duration=e),(h||c)&&n.context.contextActivities.category.push({id:"https://w3id.org/xapi/cmi5/context/categories/moveon"})),lastVerb=f,cmi5Controller.sendStatement(endPointConfig,n,sentStatement)):alert("Invalid verb passed: "+f),!1}function sentStatement(n){n&&n.status==200?(lastVerb=="Terminated"&&(MarkSuccess("btnStatement"),MarkNext("btnLMS")),jq("#spnVerbsSent").append(lastVerb+"<br/>")):alert("The server returned "+n.status)}function setAuthToken(n){n&&(setConfig(endPoint,n),jq("#txtAuthToken").val(n),GetAUProperties(),MarkSuccess("btnAuthToken"),MarkNext("btnState"))}function setAgentProfile(n){var t=JSON.parse(n.response);jq("#txtProfile").val(JSON.stringify(t,null,3));MarkSuccess("btnProfile");MarkNext("btnStatement")}function setConfig(n,t){endPointConfig={endpoint:n,auth:"Basic "+t}}function setStateDocument(n){var t=JSON.parse(n.response),i;jq("#txtState").val(JSON.stringify(t,null,3));contextActivities=t.contextTemplate.contextActivities;contextExtensions=t.contextTemplate.extensions;i=typeof t.returnURL;i=="string"&&(returnUrl=t.returnURL);masteryScore=t.masteryScore;jq("#spnMasteryScore").html("Mastery = "+masteryScore.toString());MarkSuccess("btnState");MarkNext("btnProfile")}function GetAUProperties(){jq.support.cors=!0;ADL.XAPIWrapper.changeConfig(endPointConfig);var n=ADL.XAPIWrapper.searchParams();return n.verb=ADL.verbs.launched.id,n.activity=activityId,n.registration=registration,n.limit="1",ADL.XAPIWrapper.getStatements(n,null,function(n){var i=$.parseJSON(n.response),r,t,u;i.hasOwnProperty("statements")?(t=i.statements,u=t.length):(r=i,u=1);u>0&&(t=r?$.parseJSON("["+JSON.stringify(r)+"]"):$.parseJSON(JSON.stringify(t)),jq("#AUTitle").html("- "+t[0].object.definition.name["en-US"]),auName=t[0].object.definition.name,activityProperties=t[0].object)}),!1}function MarkNext(n){jq("#"+n).removeClass("btn-success btn-default").addClass("btn-primary")}function MarkSuccess(n){jq("#"+n).removeClass("btn-primary btn-default").addClass("btn-success")}function parse(n){var t="Not found",i=[];return n=n.toUpperCase(),location.search.substr(1).split("&").forEach(function(r){i=r.split("=");i[0].toUpperCase()===n&&(t=decodeURIComponent(r.slice(-1*(r.length-r.indexOf("=")-1))))}),t}jq(function(){endPoint=parse("endpoint");fetchUrl=parse("fetch");registration=parse("registration");activityId=parse("activityid");actor=parse("actor");jq("input:radio[name='rdoVerb']").change(function(){var n=jq(this).val();n=="Initialized"&&(jq("input:radio[name='rdoComplete'][value='']").prop("checked",!0),jq("input:radio[name='rdoSuccess'][value='']").prop("checked",!0));n=="Completed"&&(jq("input:radio[name='rdoComplete'][value='true']").prop("checked",!0),jq("input:radio[name='rdoSuccess'][value='']").prop("checked",!0));n=="Passed"&&(jq("input:radio[name='rdoComplete'][value='']").prop("checked",!0),jq("input:radio[name='rdoSuccess'][value='true']").prop("checked",!0));n=="Failed"&&(jq("input:radio[name='rdoComplete'][value='false']").prop("checked",!0),jq("input:radio[name='rdoSuccess'][value='false']").prop("checked",!0));n=="Terminated"&&(jq("input:radio[name='rdoComplete'][value='']").prop("checked",!0),jq("input:radio[name='rdoSuccess'][value='']").prop("checked",!0))})});